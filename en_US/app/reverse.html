<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Reverse Proxy I | V2Ray Beginner&#39;s Guide</title>
    <meta name="generator" content="VuePress 1.9.10">
    
    <meta name="description" content="Step-by-step guide for first-timers&#39; using V2Ray.">
    
    <link rel="preload" href="/v2ray-step-by-step/assets/css/0.styles.1563b94d.css" as="style"><link rel="preload" href="/v2ray-step-by-step/assets/js/app.bdffd08e.js" as="script"><link rel="preload" href="/v2ray-step-by-step/assets/js/2.c71bed01.js" as="script"><link rel="preload" href="/v2ray-step-by-step/assets/js/1.38b668c6.js" as="script"><link rel="preload" href="/v2ray-step-by-step/assets/js/31.36f28bbf.js" as="script"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/10.0dcce457.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/100.534b4c30.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/101.8bf2b3a1.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/102.caebc59b.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/103.c2740a87.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/104.9b0e9374.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/105.fb78d4f1.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/106.a0e3d5bd.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/107.b9febb44.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/108.af5141b7.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/109.2348e58f.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/11.a92f56b2.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/110.81e83727.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/111.8408b6ea.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/112.49af295d.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/113.856d9f2c.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/114.0d65f793.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/115.f72f5248.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/116.c05728bb.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/117.a4af3104.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/118.ebd90c64.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/119.6703e933.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/12.61021ec6.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/120.117a55a2.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/121.a0588e93.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/13.aebcd1e7.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/14.73d4f0b0.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/15.8b128397.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/16.9b98030e.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/17.6653fe11.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/18.909d1979.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/19.843d385b.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/20.7612fa41.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/21.94cba406.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/22.96ccfb8e.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/23.fb6bc130.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/24.bc3bdf7d.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/25.0411e529.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/26.93eba9a2.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/27.74b9b95d.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/28.6f492c1a.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/29.1d05b470.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/3.7944ce4e.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/30.5945de90.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/32.6926c084.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/33.aa251d59.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/34.156aabdb.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/35.a8176438.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/36.0144691c.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/37.7e880667.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/38.816ba14d.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/39.7e6b2594.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/4.e879ad96.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/40.59843cb0.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/41.8563e4fa.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/42.cc48cbfa.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/43.381623c7.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/44.9cd81352.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/45.ca996df3.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/46.beab869c.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/47.beed90e6.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/48.06bd87b2.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/49.17bb9a55.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/5.1a870a66.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/50.2caf3174.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/51.05281300.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/52.da971bfc.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/53.47e78247.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/54.68553702.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/55.c38e521c.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/56.7ca8609f.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/57.81db8b47.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/58.1c73e916.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/59.05c48daf.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/6.ca9a3470.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/60.c86a1bac.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/61.b599ef99.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/62.9a363fdd.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/63.45f9f1df.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/64.301bb915.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/65.8c96c180.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/66.dce742db.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/67.64fa8048.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/68.210a9ff8.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/69.97098b7e.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/7.1eb6af94.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/70.a6b8cdea.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/71.3e3fb73e.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/72.ce052762.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/73.524ce7e3.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/74.f66d4eab.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/75.d9ddef4f.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/76.9f8f3666.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/77.b2977073.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/78.888e8b40.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/79.daad3c05.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/80.fd8c9ecb.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/81.b5edc326.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/82.4e5ef89b.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/83.a29fea4d.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/84.0dd008bb.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/85.d3189f8e.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/86.10d885ea.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/87.1264d5b8.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/88.44157b68.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/89.38786fba.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/90.6dfc59c7.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/91.cceaafec.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/92.bab6a5b9.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/93.aa6a0389.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/94.2f68870e.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/95.8216669a.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/96.dd5f3760.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/97.65c72ef6.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/98.f1eea40d.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/99.262baacc.js"><link rel="prefetch" href="/v2ray-step-by-step/assets/js/vendors~docsearch.94b65286.js">
    <link rel="stylesheet" href="/v2ray-step-by-step/assets/css/0.styles.1563b94d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/v2ray-step-by-step/en_US/" class="home-link router-link-active"><!----> <span class="site-name">V2Ray Beginner's Guide</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/v2ray-step-by-step/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="https://v2fly.org" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Official Guide
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/v2ray-step-by-step/app/reverse.html" class="nav-link">
  zh-CN
</a></li><li class="dropdown-item"><!----> <a href="/v2ray-step-by-step/en_US/app/reverse.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  en-US
</a></li></ul></div></div> <a href="https://github.com/v2fly/v2ray-step-by-step" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/v2ray-step-by-step/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="https://v2fly.org" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Official Guide
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/v2ray-step-by-step/app/reverse.html" class="nav-link">
  zh-CN
</a></li><li class="dropdown-item"><!----> <a href="/v2ray-step-by-step/en_US/app/reverse.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  en-US
</a></li></ul></div></div> <a href="https://github.com/v2fly/v2ray-step-by-step" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Preface</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/v2ray-step-by-step/en_US/" aria-current="page" class="sidebar-link">Guide to V2Ray configuration</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/v2ray-step-by-step/en_US/prep/prep" class="sidebar-heading clickable"><span>Before start</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/v2ray-step-by-step/en_US/basics/basics" class="sidebar-heading clickable"><span>Basics</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/v2ray-step-by-step/en_US/advanced/advanced" class="sidebar-heading clickable"><span>Advanced</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/v2ray-step-by-step/en_US/app/app" class="sidebar-heading clickable open"><span>Practical</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/v2ray-step-by-step/en_US/app/transparent_proxy.html" class="sidebar-link">Transparent Proxy</a></li><li><a href="/v2ray-step-by-step/en_US/app/reverse.html" aria-current="page" class="active sidebar-link">Reverse Proxy I</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/v2ray-step-by-step/en_US/app/reverse.html#mechanism" class="sidebar-link">Mechanism</a></li><li class="sidebar-sub-header"><a href="/v2ray-step-by-step/en_US/app/reverse.html#configuration-example" class="sidebar-link">Configuration Example</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/v2ray-step-by-step/en_US/app/reverse.html#configuration-of-node-a" class="sidebar-link">Configuration of Node A</a></li><li class="sidebar-sub-header"><a href="/v2ray-step-by-step/en_US/app/reverse.html#configuration-of-node-b" class="sidebar-link">Configuration of Node B</a></li></ul></li><li class="sidebar-sub-header"><a href="/v2ray-step-by-step/en_US/app/reverse.html#access" class="sidebar-link">Access</a></li></ul></li><li><a href="/v2ray-step-by-step/en_US/app/reverse2.html" class="sidebar-link">Reverse Proxy II</a></li><li><a href="/v2ray-step-by-step/en_US/app/parent.html" class="sidebar-link">Forward Proxy</a></li><li><a href="/v2ray-step-by-step/en_US/app/balance.html" class="sidebar-link">Load Balancing</a></li><li><a href="/v2ray-step-by-step/en_US/app/docker-deploy-v2ray.html" class="sidebar-link">Deploying V2Ray by Docker</a></li><li><a href="/v2ray-step-by-step/en_US/app/benchmark.html" class="sidebar-link">Benchmark</a></li><li><a href="/v2ray-step-by-step/en_US/app/optimization.html" class="sidebar-link">Memory optimization</a></li><li><a href="/v2ray-step-by-step/en_US/app/tinc_proxy.html" class="sidebar-link">Mount the Tinc LAN node</a></li><li><a href="/v2ray-step-by-step/en_US/app/android_without_root_use_v2ray.html" class="sidebar-link">Android Root-free running core</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/v2ray-step-by-step/en_US/routing/routing" class="sidebar-heading clickable"><span>Routing</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="reverse-proxy-i"><a href="#reverse-proxy-i" class="header-anchor">#</a> Reverse Proxy I</h1> <p>The reverse proxy is a relatively high-mentioned feature request. Since the v2.x release, many people have asked developers if they can join this feature until v4.0 is finally available. The reverse proxy is mainly used for intranet penetration. It uses VPS to access intranet servers that do not have public IP. The specific example is that there is a NAS in the house. Because when your home broadband does not have a public IP, you can't directly access your NAS outside. But you can access the home NAS with a reverse proxy. If you don't have relative requirements, there is no need to read the following section.</p> <p>When we talking about the reverse proxy, it must be indicated that FRP is widely used today. But in this tutorial, we will not discuss which one is better. However, the configuration of V2Ray is more difficult to understand. You will need to have a better understanding of V2Ray to configure the reverse proxy.</p> <h2 id="mechanism"><a href="#mechanism" class="header-anchor">#</a> Mechanism</h2> <p>For your easier understanding, assuming there are three types of devices in this section, A, B and C. Type of devices A does not have a public IP to access the internet, and it is running as a NAS or personal cloud. Type of devices B is a server which has a public IP address, like your VPS. Type of devices C is the device you want to use it access the NAS or personal cloud on device A. (Assuming you have a private cloud disk on device A, like NextCloud, and it listens to 80 port). Each of these three types of devices can be one or more. Let us first discuss one device for one type of case. To be able to establish a reverse proxy connection, both A and B must run V2Ray, and C may not run V2Ray. After setting up the configuration file and running V2Ray, the order of traffic delay in which the connections are established in the reverse proxy is:</p> <ol><li>A will initiate a request to B to establish a connection;</li> <li>The user C initiates a request to B to access the private cloud disk on A;</li> <li>B accepts the request of C, and forwards the traffic to A (that is, B reversely connects A);</li></ol> <p>The effect of the above process is equivalent to initiate a request from C to A, for accessing A's private network disk. A initiates a request to B, A needs an outbound, and B needs an inbound. (Because A's outbound is inbound to B, there are three protocols with inbound and outbound: VMess, Shadowsocks, and Socks. In this section we take VMess as an example). C initiates a request to B, B also needs an inbound, C does not run V2Ray (B's inbound to accept traffic that is not from V2Ray, can only be dokodemo-door). Because A is the final server of accessing (private network disk), A also needs an outbound, namely freedom. In other words, A requires two outbounds (VMess and freedom), and B requires two inbounds (VMess and dokodemo-door). Then in order for A to actively connect to B, A needs to configure a reverse proxy. Similarly, in order to allow B to connect back to A, B also needs to configure a reverse proxy. Finally, we need to configure the route.</p> <p><img src="/v2ray-step-by-step/assets/img/block_of_reverse-doko.6abc2d13.png" alt=""></p> <h2 id="configuration-example"><a href="#configuration-example" class="header-anchor">#</a> Configuration Example</h2> <p>The specific configuration is given below, please understand the description in the previous principle section.</p> <h3 id="configuration-of-node-a"><a href="#configuration-of-node-a" class="header-anchor">#</a> Configuration of Node A</h3> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>  
  <span class="token property">&quot;reverse&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span> 
    <span class="token comment">// This is the reverse proxy setting for A and must have the object of the following bridge</span>
    <span class="token property">&quot;bridges&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>  
      <span class="token punctuation">{</span>  
        <span class="token property">&quot;tag&quot;</span><span class="token operator">:</span><span class="token string">&quot;bridge&quot;</span><span class="token punctuation">,</span> <span class="token comment">// The reverse proxy tag of A, used in routing</span>
        <span class="token property">&quot;domain&quot;</span><span class="token operator">:</span><span class="token string">&quot;private.cloud.com&quot;</span> <span class="token comment">// The domain name of the reverse proxy communication between A and B can be self-assigned. It may not be bought from the domain registry service provider, but it must be consistent with the reverse configured domain name in B below.</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;outbounds&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>  
      <span class="token comment">//The outbound of A connecting to B</span>
      <span class="token property">&quot;tag&quot;</span><span class="token operator">:</span><span class="token string">&quot;tunnel&quot;</span><span class="token punctuation">,</span> <span class="token comment">// The tag of outbound of A connecting to B, will be used in the following routing setting</span>
      <span class="token property">&quot;protocol&quot;</span><span class="token operator">:</span><span class="token string">&quot;vmess&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;settings&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>  
        <span class="token property">&quot;vnext&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>  
          <span class="token punctuation">{</span>  
            <span class="token property">&quot;address&quot;</span><span class="token operator">:</span><span class="token string">&quot;serveraddr.com&quot;</span><span class="token punctuation">,</span> <span class="token comment">// Address of B can be an IP or a domian</span>
            <span class="token property">&quot;port&quot;</span><span class="token operator">:</span><span class="token number">16823</span><span class="token punctuation">,</span>
            <span class="token property">&quot;users&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>  
              <span class="token punctuation">{</span>  
                <span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;b831381d-6324-4d53-ad4f-8cda48b30811&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;alterId&quot;</span><span class="token operator">:</span><span class="token number">64</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">]</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// Another outbound connect of the private cloud disk</span>
    <span class="token punctuation">{</span>  
      <span class="token property">&quot;protocol&quot;</span><span class="token operator">:</span><span class="token string">&quot;freedom&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;settings&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>  
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;tag&quot;</span><span class="token operator">:</span><span class="token string">&quot;out&quot;</span>
    <span class="token punctuation">}</span>    
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;routing&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>   
    <span class="token property">&quot;rules&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>  
      <span class="token punctuation">{</span>  
        <span class="token comment">// Configure the routing rules for A connecting to B</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;field&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;inboundTag&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>  
          <span class="token string">&quot;bridge&quot;</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">&quot;domain&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>  
          <span class="token string">&quot;full:private.cloud.com&quot;</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">&quot;outboundTag&quot;</span><span class="token operator">:</span><span class="token string">&quot;tunnel&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>  
        <span class="token comment">// The routing rules for reverse connection of private cloud disk</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;field&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;inboundTag&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>  
          <span class="token string">&quot;bridge&quot;</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">&quot;outboundTag&quot;</span><span class="token operator">:</span><span class="token string">&quot;out&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="configuration-of-node-b"><a href="#configuration-of-node-b" class="header-anchor">#</a> Configuration of Node B</h3> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>  
  <span class="token property">&quot;reverse&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>  <span class="token comment">// This is the reverse proxy setting for B and must have the following portals object</span>
    <span class="token property">&quot;portals&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>  
      <span class="token punctuation">{</span>  
        <span class="token property">&quot;tag&quot;</span><span class="token operator">:</span><span class="token string">&quot;portal&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;domain&quot;</span><span class="token operator">:</span><span class="token string">&quot;private.cloud.com&quot;</span> <span class="token comment">// must be the same as the domain name set by A above</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;inbounds&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>  
      <span class="token comment">// Accept C's inbound</span>
      <span class="token property">&quot;tag&quot;</span><span class="token operator">:</span><span class="token string">&quot;external&quot;</span><span class="token punctuation">,</span> <span class="token comment">// tag, used in routing</span>
      <span class="token property">&quot;port&quot;</span><span class="token operator">:</span><span class="token number">80</span><span class="token punctuation">,</span>
      <span class="token comment">// Open port 80 for receiving external HTTP access </span>
      <span class="token property">&quot;protocol&quot;</span><span class="token operator">:</span><span class="token string">&quot;dokodemo-door&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;settings&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>  
          <span class="token property">&quot;address&quot;</span><span class="token operator">:</span><span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;port&quot;</span><span class="token operator">:</span><span class="token number">80</span><span class="token punctuation">,</span> <span class="token comment">// Suppose the port that the NAS is listening on is 80.</span>
          <span class="token property">&quot;network&quot;</span><span class="token operator">:</span><span class="token string">&quot;tcp&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// Another inbound that accepts a request initiated by A</span>
    <span class="token punctuation">{</span>  
      <span class="token property">&quot;tag&quot;</span><span class="token operator">:</span> <span class="token string">&quot;tunnel&quot;</span><span class="token punctuation">,</span><span class="token comment">// tag, used in routing</span>
      <span class="token property">&quot;port&quot;</span><span class="token operator">:</span><span class="token number">16823</span><span class="token punctuation">,</span>
      <span class="token property">&quot;protocol&quot;</span><span class="token operator">:</span><span class="token string">&quot;vmess&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;settings&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>  
        <span class="token property">&quot;clients&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>  
          <span class="token punctuation">{</span>  
            <span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;b831381d-6324-4d53-ad4f-8cda48b30811&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;alterId&quot;</span><span class="token operator">:</span><span class="token number">64</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;routing&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>  
    <span class="token property">&quot;rules&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>  
      <span class="token punctuation">{</span>  <span class="token comment">// Routing rules, sent to A after receiving a C request</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;field&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;inboundTag&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>  
          <span class="token string">&quot;external&quot;</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">&quot;outboundTag&quot;</span><span class="token operator">:</span><span class="token string">&quot;portal&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>  <span class="token comment">// Routing rules that let B recognize that this is a proactively initiated reverse proxy connection</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;field&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;inboundTag&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>  
          <span class="token string">&quot;tunnel&quot;</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">&quot;domain&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>  
          <span class="token string">&quot;full:private.cloud.com&quot;</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">&quot;outboundTag&quot;</span><span class="token operator">:</span><span class="token string">&quot;portal&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="access"><a href="#access" class="header-anchor">#</a> Access</h2> <p>After configuring the V2Ray configuration of A and B, run V2Ray of A and B successively, and also set up the private network disk of A to run. Then C accesses a different network than A (for example, to the neighbour's home network), and uses the browser to access the IP or domain name of B. At this time, the intranet can access the private cloud disk.</p> <h4 id="updates"><a href="#updates" class="header-anchor">#</a> Updates</h4> <ul><li>2018-10-31 Initial release</li> <li>2019-01-13 V4.0+ Adaptation</li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">4/28/2024, 1:03:52 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/v2ray-step-by-step/en_US/app/transparent_proxy.html" class="prev">
        Transparent Proxy
      </a></span> <span class="next"><a href="/v2ray-step-by-step/en_US/app/reverse2.html">
        Reverse Proxy II
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/v2ray-step-by-step/assets/js/app.bdffd08e.js" defer></script><script src="/v2ray-step-by-step/assets/js/2.c71bed01.js" defer></script><script src="/v2ray-step-by-step/assets/js/1.38b668c6.js" defer></script><script src="/v2ray-step-by-step/assets/js/31.36f28bbf.js" defer></script>
  </body>
</html>
